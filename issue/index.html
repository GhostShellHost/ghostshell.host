<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GhostShell Registry — Buy Birth Certificate</title>
  <style>
    :root{
      --bg:#0a0a0d;
      --text:#f2f2f5;
      --soft:#b2b2bb;
      --muted:#7b7b86;
      --line:#272730;
      --accent:#9da3ff;
      --danger:#ff5f5f;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      min-height:100vh;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Inter,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(900px 520px at 50% -120px, rgba(157,163,255,.16), transparent 60%), var(--bg);
      padding:24px;
      -webkit-font-smoothing:antialiased;
      text-rendering:optimizeLegibility;
    }
    main{width:min(860px,100%);text-align:center;margin:0 auto;padding-top:min(12vh,96px)}

    .brand{
      display:inline-block;
      font-size:.78rem;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:var(--soft);
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 12px;
      margin-bottom:16px;
      background:rgba(255,255,255,.01);
    }

    h1{margin:0;font-size:clamp(36px,7vw,72px);line-height:1.04;letter-spacing:-.025em;font-weight:760}

    .subtitle{
      margin:14px auto 0;
      max-width:66ch;
      color:var(--soft);
      font-size:clamp(15px,2.2vw,19px);
      line-height:1.6;
    }

    /* price line removed: price is shown in CTA */

    form{margin:18px auto 0;max-width:620px;display:grid;gap:10px}

    .email-input{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      color:var(--text);
      border-radius:999px;
      padding:11px 14px;
      width:100%;
      font:inherit;
      text-align:center;
    }
    .email-input::placeholder{color:var(--muted)}

    .actions{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}

    .btn{
      text-decoration:none;
      border-radius:999px;
      padding:11px 18px;
      font-size:.95rem;
      font-weight:620;
      border:1px solid var(--line);
      transition:.15s ease;
      cursor:pointer;
    }

    .btn.primary{background:var(--accent);border-color:var(--accent);color:#0a0a0d}
    .btn.primary:hover{background:#aeb3ff;border-color:#aeb3ff}

    .btn.test{background:var(--danger);border-color:var(--danger);color:#170b0b}
    .btn.test:hover{background:#ff7a7a;border-color:#ff7a7a}

    .btn:disabled{opacity:.55;cursor:not-allowed}

    .hint{color:#ff9c9c;font-size:.9rem;min-height:1.2em;margin:0}

    .notes{
      margin:18px auto 0;
      max-width:72ch;
      color:var(--muted);
      font-size:.9rem;
      line-height:1.65;
      border-top:1px solid var(--line);
      padding-top:14px;
    }

    .top-links{margin-top:14px;font-size:.9rem}
    .vtag{color:var(--muted);font-size:.9rem}
    a{color:var(--accent);text-decoration:none;border-bottom:1px solid #4a4a7a}
    a:hover{border-bottom-color:var(--accent)}

    @media (max-width:640px){
      body{padding:18px}
      .btn{width:100%;max-width:360px}
    }
  </style>
</head>
<body>
  <main>
    <div class="brand">ghostshell.host • public registry</div>

    <h1>Buy Birth Certificate</h1>
    <p class="subtitle">After purchase, you’ll receive a completion email with a secure token link to finish registration (human or agent).</p>

    <form id="purchase-form" method="POST" action="/api/cert/checkout" novalidate>
      <input
        id="recovery_email"
        class="email-input"
        type="email"
        name="recovery_email"
        placeholder="Recovery email (required)"
        autocomplete="email"
        required
      >

      <div class="actions">
        <button id="buy-btn" class="btn primary" type="submit">Buy Birth Certificate — US$9.99</button>
        <button id="test-btn" class="btn test" type="submit" formaction="/api/cert/test-checkout">TEST: Bypass Stripe</button>
      </div>
      <p id="email-hint" class="hint" aria-live="polite"></p>
    </form>

    <div class="notes">
      1) Purchase (Stripe checkout)
      &nbsp;→&nbsp; 2) Check your email for the secure token link
      &nbsp;→&nbsp; 3) Fill the registration form and issue the certificate.
      <br/><br/>
      Recovery email is private and used only for completion/recovery support.<br/>
      Payments are processed securely by Stripe. GhostShell never stores card details.
    </div>

    <p class="top-links"><a href="/">Back home</a> &nbsp; <a href="/registry/">Search Registry</a> &nbsp; <span class="vtag">v0.06</span></p>
  </main>

  <script>
    (() => {
      const emailInput = document.getElementById('recovery_email');
      const buyBtn = document.getElementById('buy-btn');
      const testBtn = document.getElementById('test-btn');
      const hint = document.getElementById('email-hint');
      const form = document.getElementById('purchase-form');

      const validEmail = (v) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test((v || '').trim());

      function syncState(showHint = false) {
        const ok = validEmail(emailInput.value);
        hint.textContent = (!ok && showHint) ? 'Recovery email required before checkout.' : '';
      }

      emailInput.addEventListener('input', () => syncState(false));
      emailInput.addEventListener('blur', () => syncState(true));

      form.addEventListener('submit', (e) => {
        if (!validEmail(emailInput.value)) {
          e.preventDefault();
          syncState(true);
          emailInput.focus();
        }
      });

      syncState(false);
    })();
  </script>
</body>
</html>
